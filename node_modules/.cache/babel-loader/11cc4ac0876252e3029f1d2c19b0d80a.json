{"ast":null,"code":"var _jsxFileName = \"/Users/swalihvpm/Desktop/django-react/django-react-ecommerce/src/components/OrderSummary/OrderSummary.js\";\nimport React, { Component } from \"react\";\nimport { Button, Container, Dimmer, Divider, Form, Header, Image, Item, Label, Loader, Message, Segment, Select, Radio } from \"semantic-ui-react\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport { makeStyles, withStyles } from \"@material-ui/core/styles\";\nimport JssProvider from \"react-jss/lib/JssProvider\";\nimport { createGenerateClassName } from \"@material-ui/core/styles\";\nimport { MuiThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { Alert, AlertTitle } from \"@material-ui/lab\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { authAxios } from \"../../utils\";\nimport { checkoutURL, orderSummaryURL, addCouponURL, addressListURL } from \"../../constants\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: \"100%\",\n    marginTop: theme.spacing.unit * 3,\n    overflowX: \"auto\"\n  },\n  table: {\n    minWidth: 200\n  },\n  tableHead: {\n    background: \"#3f51b5\",\n    color: \"white\",\n    fontWeigth: \"bold\",\n    fontSize: \"20pt\"\n  },\n  tablecell: {\n    fontSize: \"12pt\"\n  }\n}));\n\nconst OrderPreview = props => {\n  const {\n    data\n  } = props;\n  const classes = useStyles();\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.TopPadding,\n    style: {\n      width: 400\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"customized table\",\n    style: {\n      width: 400\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableRow // style={{\n  //   backgroundColor: \"#3f51b5\",\n  //   color: \"white\",\n  //   fontSize: 20\n  // }}\n  , {\n    className: classes.tableHead,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  }, \"Item\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 17\n    }\n  }, \"Quantity\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, \"Price\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, data !== null ? /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }, data.order_items.map(order_item => {\n    return /*#__PURE__*/React.createElement(TableRow, {\n      key: order_item.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 25\n      }\n    }, order_item.item.title), /*#__PURE__*/React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }\n    }, order_item.quantity), /*#__PURE__*/React.createElement(TableCell, {\n      align: \"left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 25\n      }\n    }, order_item.final_price));\n  }), /*#__PURE__*/React.createElement(TableRow, {\n    style: {\n      backgroundColor: \"#9fa8da\",\n      color: \"white\",\n      fontSize: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    colSpan: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }, \"Total\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }, data.total))) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, \"No Item in your cart\"))))));\n}; // class CouponForm extends Component {\n//   state = {\n//     code: \"\"\n//   };\n//   handleChange = e => {\n//     this.setState({\n//       code: e.target.value\n//     });\n// //   };\n//   handleSubmit = e => {\n//     const { code } = this.state;\n//     this.props.handleAddCoupon(e, code);\n//     this.setState({ code: \"\" });\n//   };\n//   render() {\n//     const { code } = this.state;\n//     return (\n//       <React.Fragment>\n//         <Container>\n//           <Form onSubmit={this.handleSubmit}>\n//             <Form.Field>\n//               <label>Coupon code</label>\n//               <input\n//                 placeholder=\"Enter a coupon..\"\n//                 value={code}\n//                 onChange={this.handleChange}\n//               />\n//             </Form.Field>\n//             <Button type=\"submit\">Submit</Button>\n//           </Form>\n//         </Container>\n//       </React.Fragment>\n//     );\n//   }\n// }\n\n\nclass CheckoutForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: null,\n      loading: false,\n      error: null,\n      success: false,\n      shippingAddresses: [],\n      billingAddresses: [],\n      selectedBillingAddress: \"\",\n      selectedShippingAddress: \"\",\n      shop: \"\",\n      place: \"\",\n      mode_of_payment: \"\"\n    };\n\n    this.handleGetDefaultAddress = addresses => {\n      const filteredAddresses = addresses.filter(el => el.default === true);\n\n      if (filteredAddresses.length > 0) {\n        return filteredAddresses[0].id;\n      }\n\n      return \"\";\n    };\n\n    this.handleFetchShippingAddresses = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(addressListURL(\"S\")).then(res => {\n        this.setState({\n          shippingAddresses: res.data.map(a => {\n            return {\n              key: a.id,\n              text: `${a.place}, ${a.area}, ${a.road_name}`,\n              value: a.id\n            };\n          }),\n          selectedShippingAddress: this.handleGetDefaultAddress(res.data),\n          loading: false\n        });\n      }).catch(err => {\n        this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    this.handleFetchOrder = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(orderSummaryURL).then(res => {\n        this.setState({\n          data: res.data,\n          loading: false\n        });\n      }).catch(err => {\n        if (err.response.status === 404) {\n          this.props.history.push(\"/orders\");\n        } else {\n          this.setState({\n            error: err,\n            loading: false\n          });\n        }\n      });\n    };\n\n    this.handleSelectChange = (e, {\n      name,\n      value\n    }) => {\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.submit = ev => {\n      ev.preventDefault();\n      this.setState({\n        loading: true\n      });\n      const {\n        selectedBillingAddress,\n        selectedShippingAddress,\n        mode_of_payment\n      } = this.state;\n      authAxios.post(checkoutURL, {\n        selectedBillingAddress,\n        selectedShippingAddress,\n        mode_of_payment\n      }).then(res => {\n        this.setState({\n          loading: false,\n          success: true\n        });\n        this.redirectToOrders();\n      }).catch(err => {\n        this.setState({\n          loading: false,\n          error: err\n        });\n      });\n    };\n\n    this.handleSelectChangeAddress = e => {\n      this.setState({\n        selectedShippingAddress: e.target.value\n      });\n      console.log(e.target.value);\n    };\n  }\n\n  componentDidMount() {\n    this.handleFetchOrder(); // this.handleFetchBillingAddresses();\n\n    this.handleFetchShippingAddresses();\n  }\n\n  redirectToOrders() {\n    setTimeout(this.props.history.push(\"/orders\"), 10000);\n  }\n\n  render() {\n    const {\n      data,\n      error,\n      loading,\n      success,\n      billingAddresses,\n      shippingAddresses,\n      selectedBillingAddress,\n      selectedShippingAddress,\n      mode_of_payment\n    } = this.state;\n    console.log(data);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }\n    }, loading && /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(CircularProgress, {\n      color: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 15\n      }\n    })), error && /*#__PURE__*/React.createElement(Alert, {\n      severity: \"error\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(AlertTitle, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 15\n      }\n    }, JSON.stringify(error))), /*#__PURE__*/React.createElement(OrderPreview, {\n      data: data,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 11\n      }\n    }, \"Select Address\"), shippingAddresses.length > 0 ? /*#__PURE__*/React.createElement(Select, {\n      name: \"selectedShippingAddress\",\n      value: selectedShippingAddress,\n      clearable: true,\n      options: shippingAddresses,\n      selection: true,\n      onChange: this.handleSelectChangeAddress,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 13\n      }\n    }) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 13\n      }\n    }, \"You need to \", /*#__PURE__*/React.createElement(Link, {\n      to: \"/profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 27\n      }\n    }, \"add an address\")), shippingAddresses.length < 1 ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 13\n      }\n    }, \"You need to add an addresse to complete your purchase\") : /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 15\n      }\n    }, \"Confirm Order?\"), success && /*#__PURE__*/React.createElement(Alert, {\n      severity: \"success\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(AlertTitle, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 19\n      }\n    }, \"Your Order is successful\")), /*#__PURE__*/React.createElement(Button, {\n      loading: loading,\n      disabled: loading,\n      primary: true,\n      onClick: this.submit,\n      style: {\n        marginTop: \"10px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 15\n      }\n    }, \"Submit\"))));\n  }\n\n}\n\nexport default CheckoutForm;","map":{"version":3,"sources":["/Users/swalihvpm/Desktop/django-react/django-react-ecommerce/src/components/OrderSummary/OrderSummary.js"],"names":["React","Component","Button","Container","Dimmer","Divider","Form","Header","Image","Item","Label","Loader","Message","Segment","Select","Radio","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","makeStyles","withStyles","JssProvider","createGenerateClassName","MuiThemeProvider","createMuiTheme","CircularProgress","Alert","AlertTitle","Link","withRouter","authAxios","checkoutURL","orderSummaryURL","addCouponURL","addressListURL","useStyles","theme","root","width","marginTop","spacing","unit","overflowX","table","minWidth","tableHead","background","color","fontWeigth","fontSize","tablecell","OrderPreview","props","data","classes","TopPadding","order_items","map","order_item","id","item","title","quantity","final_price","backgroundColor","total","CheckoutForm","state","loading","error","success","shippingAddresses","billingAddresses","selectedBillingAddress","selectedShippingAddress","shop","place","mode_of_payment","handleGetDefaultAddress","addresses","filteredAddresses","filter","el","default","length","handleFetchShippingAddresses","setState","get","then","res","a","key","text","area","road_name","value","catch","err","handleFetchOrder","response","status","history","push","handleSelectChange","e","name","submit","ev","preventDefault","post","redirectToOrders","handleSelectChangeAddress","target","console","log","componentDidMount","setTimeout","render","JSON","stringify"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  Button,\n  Container,\n  Dimmer,\n  Divider,\n  Form,\n  Header,\n  Image,\n  Item,\n  Label,\n  Loader,\n  Message,\n  Segment,\n  Select,\n  Radio\n} from \"semantic-ui-react\";\n\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport { makeStyles, withStyles } from \"@material-ui/core/styles\";\nimport JssProvider from \"react-jss/lib/JssProvider\";\nimport { createGenerateClassName } from \"@material-ui/core/styles\";\nimport { MuiThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { Alert, AlertTitle } from \"@material-ui/lab\";\n\nimport { Link, withRouter } from \"react-router-dom\";\nimport { authAxios } from \"../../utils\";\nimport {\n  checkoutURL,\n  orderSummaryURL,\n  addCouponURL,\n  addressListURL\n} from \"../../constants\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: \"100%\",\n    marginTop: theme.spacing.unit * 3,\n    overflowX: \"auto\"\n  },\n  table: {\n    minWidth: 200\n  },\n  tableHead: {\n    background: \"#3f51b5\",\n    color: \"white\",\n    fontWeigth: \"bold\",\n    fontSize: \"20pt\"\n  },\n  tablecell: {\n    fontSize: \"12pt\"\n  }\n}));\n\nconst OrderPreview = props => {\n  const { data } = props;\n  const classes = useStyles();\n\n  return (\n    <React.Fragment>\n      <div className={classes.TopPadding} style={{ width: 400 }}>\n        <TableContainer component={Paper}>\n          <Table\n            className={classes.table}\n            aria-label=\"customized table\"\n            style={{ width: 400 }}\n          >\n            <TableHead>\n              <TableRow\n                // style={{\n                //   backgroundColor: \"#3f51b5\",\n                //   color: \"white\",\n                //   fontSize: 20\n                // }}\n                className={classes.tableHead}\n              >\n                <TableCell align=\"left\">Item</TableCell>\n                <TableCell align=\"left\">Quantity</TableCell>\n                <TableCell align=\"left\">Price</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {data !== null ? (\n                <React.Fragment>\n                  {data.order_items.map(order_item => {\n                    return (\n                      <TableRow key={order_item.id}>\n                        <TableCell component=\"th\" scope=\"row\">\n                          {order_item.item.title}\n                        </TableCell>\n                        <TableCell component=\"th\" scope=\"row\">\n                          {order_item.quantity}\n                        </TableCell>\n                        <TableCell align=\"left\">\n                          {order_item.final_price}\n                        </TableCell>\n                      </TableRow>\n                    );\n                  })}\n                  <TableRow\n                    style={{\n                      backgroundColor: \"#9fa8da\",\n                      color: \"white\",\n                      fontSize: 20\n                    }}\n                  >\n                    {/* <TableCell rowSpan={2} /> */}\n                    <TableCell colSpan={2}>Total</TableCell>\n                    <TableCell align=\"left\">{data.total}</TableCell>\n                  </TableRow>\n                </React.Fragment>\n              ) : (\n                <div>No Item in your cart</div>\n              )}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      </div>\n    </React.Fragment>\n  );\n};\n\n// class CouponForm extends Component {\n//   state = {\n//     code: \"\"\n//   };\n\n//   handleChange = e => {\n//     this.setState({\n//       code: e.target.value\n//     });\n// //   };\n\n//   handleSubmit = e => {\n//     const { code } = this.state;\n//     this.props.handleAddCoupon(e, code);\n//     this.setState({ code: \"\" });\n//   };\n\n//   render() {\n//     const { code } = this.state;\n//     return (\n//       <React.Fragment>\n//         <Container>\n//           <Form onSubmit={this.handleSubmit}>\n//             <Form.Field>\n//               <label>Coupon code</label>\n//               <input\n//                 placeholder=\"Enter a coupon..\"\n//                 value={code}\n//                 onChange={this.handleChange}\n//               />\n//             </Form.Field>\n//             <Button type=\"submit\">Submit</Button>\n//           </Form>\n//         </Container>\n//       </React.Fragment>\n//     );\n//   }\n// }\n\nclass CheckoutForm extends Component {\n  state = {\n    data: null,\n    loading: false,\n    error: null,\n    success: false,\n    shippingAddresses: [],\n    billingAddresses: [],\n    selectedBillingAddress: \"\",\n    selectedShippingAddress: \"\",\n    shop: \"\",\n    place: \"\",\n    mode_of_payment: \"\"\n  };\n\n  componentDidMount() {\n    this.handleFetchOrder();\n    // this.handleFetchBillingAddresses();\n    this.handleFetchShippingAddresses();\n  }\n\n  handleGetDefaultAddress = addresses => {\n    const filteredAddresses = addresses.filter(el => el.default === true);\n    if (filteredAddresses.length > 0) {\n      return filteredAddresses[0].id;\n    }\n    return \"\";\n  };\n\n  // handleFetchBillingAddresses = () => {\n  //   this.setState({ loading: true });\n  //   authAxios\n  //     .get(addressListURL(\"B\"))\n  //     .then(res => {\n  //       this.setState({\n  //         billingAddresses: res.data.map(a => {\n  //           return {\n  //             key: a.id,\n  //             text: `${a.place}, ${a.area}, ${a.road_name}`,\n  //             value: a.id\n  //           };\n  //         }),\n  //         selectedBillingAddress: this.handleGetDefaultAddress(res.data),\n  //         loading: false\n  //       });\n  //     })\n  //     .catch(err => {\n  //       this.setState({ error: err, loading: false });\n  //     });\n  // };\n\n  handleFetchShippingAddresses = () => {\n    this.setState({ loading: true });\n    authAxios\n      .get(addressListURL(\"S\"))\n      .then(res => {\n        this.setState({\n          shippingAddresses: res.data.map(a => {\n            return {\n              key: a.id,\n              text: `${a.place}, ${a.area}, ${a.road_name}`,\n              value: a.id\n            };\n          }),\n          selectedShippingAddress: this.handleGetDefaultAddress(res.data),\n\n          loading: false\n        });\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  handleFetchOrder = () => {\n    this.setState({ loading: true });\n    authAxios\n      .get(orderSummaryURL)\n      .then(res => {\n        this.setState({ data: res.data, loading: false });\n      })\n      .catch(err => {\n        if (err.response.status === 404) {\n          this.props.history.push(\"/orders\");\n        } else {\n          this.setState({ error: err, loading: false });\n        }\n      });\n  };\n\n  // handleAddCoupon = (e, code) => {\n  //   e.preventDefault();\n  //   this.setState({ loading: true });\n  //   authAxios\n  //     .post(addCouponURL, { code })\n  //     .then(res => {\n  //       this.setState({ loading: false });\n  //       this.handleFetchOrder();\n  //     })\n  //     .catch(err => {\n  //       this.setState({ error: err, loading: false });\n  //     });\n  // };\n\n  handleSelectChange = (e, { name, value }) => {\n    this.setState({ [name]: value });\n  };\n\n  submit = ev => {\n    ev.preventDefault();\n    this.setState({ loading: true });\n    const {\n      selectedBillingAddress,\n      selectedShippingAddress,\n      mode_of_payment\n    } = this.state;\n    authAxios\n      .post(checkoutURL, {\n        selectedBillingAddress,\n        selectedShippingAddress,\n        mode_of_payment\n      })\n      .then(res => {\n        this.setState({ loading: false, success: true });\n        this.redirectToOrders();\n      })\n      .catch(err => {\n        this.setState({ loading: false, error: err });\n      });\n  };\n\n  redirectToOrders() {\n    setTimeout(this.props.history.push(\"/orders\"), 10000);\n  }\n\n  handleSelectChangeAddress = e => {\n    this.setState({ selectedShippingAddress: e.target.value });\n    console.log(e.target.value);\n  };\n\n  render() {\n    const {\n      data,\n      error,\n      loading,\n      success,\n      billingAddresses,\n      shippingAddresses,\n      selectedBillingAddress,\n      selectedShippingAddress,\n      mode_of_payment\n    } = this.state;\n    console.log(data);\n    return (\n      <div>\n        <Container>\n          {loading && (\n            <div>\n              <CircularProgress />\n              <CircularProgress color=\"secondary\" />\n            </div>\n          )}\n          {error && (\n            <Alert severity=\"error\">\n              <AlertTitle>{JSON.stringify(error)}</AlertTitle>\n            </Alert>\n          )}\n          <OrderPreview data={data} />\n\n          <Header>Select Address</Header>\n          {shippingAddresses.length > 0 ? (\n            <Select\n              name=\"selectedShippingAddress\"\n              value={selectedShippingAddress}\n              clearable\n              options={shippingAddresses}\n              selection\n              onChange={this.handleSelectChangeAddress}\n            />\n          ) : (\n            <p>\n              You need to <Link to=\"/profile\">add an address</Link>\n            </p>\n          )}\n\n          {/* <Divider /> */}\n          {/* <Header>Select a payment method</Header>\n          <Form.Field\n            control={Radio}\n            label=\"Cash on Delivery\"\n            name=\"mode_of_payment\"\n            value=\"Cash on Delivery\"\n            // checked={value === \"Cash on Delivery\"}\n            onChange={this.handleSelectChange}\n          />\n          <Form.Field\n            control={Radio}\n            label=\"Kadam\"\n            name=\"mode_of_payment\"\n            value=\"Kadam\"\n            // checked={value === \"Kadam\"}\n            onChange={this.handleSelectChange}\n          /> */}\n\n          {/* {billingAddresses.length < 1 || shippingAddresses.length < 1 ? ( */}\n          {shippingAddresses.length < 1 ? (\n            <p>You need to add an addresse to complete your purchase</p>\n          ) : (\n            <React.Fragment>\n              <Header>Confirm Order?</Header>\n\n              {success && (\n                <Alert severity=\"success\">\n                  <AlertTitle>{\"Your Order is successful\"}</AlertTitle>\n                  {/* This is an error alert â€” <strong>check it out!</strong> */}\n                </Alert>\n              )}\n              <Button\n                loading={loading}\n                disabled={loading}\n                primary\n                onClick={this.submit}\n                style={{ marginTop: \"10px\" }}\n              >\n                Submit\n              </Button>\n            </React.Fragment>\n          )}\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default CheckoutForm;\n"]},"metadata":{},"sourceType":"module"}